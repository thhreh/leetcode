First only consider double duplicate. Also logic isn't clear.
